(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["manage_users"],{a210:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md10:""}},[a("v-card",{staticClass:"mx-auto"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[a("div"),a("div",[a("div",{staticClass:"ml-4 mr-4"},[a("h3",{staticClass:"mt-6 ml-5 mb-5 text-center"},[e._v("Managers users")])])]),e._l(e.realdata,(function(t){return a("v-form",{key:t.text,staticClass:"ml-4 mr-4",on:{submit:function(e){e.preventDefault()}}},[a("v-text-field",{attrs:{type:"text",label:"Name",readonly:1==e.isReadOnly},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"details.name"}}),a("v-text-field",{attrs:{type:"text",label:"Number",readonly:1==e.isReadOnly},model:{value:t.number,callback:function(a){e.$set(t,"number",a)},expression:"details.number"}}),a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"6"}},[a("v-select",{attrs:{items:["ADMIN","AGENT"],readonly:1==e.isReadOnly,label:"Role",dense:"",outlined:""},model:{value:t.role,callback:function(a){e.$set(t,"role",a)},expression:"details.role"}})],1),a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"3"}},[e.editing?a("v-btn",{staticClass:"ml-4 mr-4",attrs:{type:"submit",color:"primary"},on:{click:function(t){return t.preventDefault(),e.editData()}}},[e._v("Edit User")]):a("v-btn",{staticClass:"ml-4 mr-4",attrs:{type:"submit",color:"green"},on:{click:function(a){return a.preventDefault(),e.updateUser(t.userUid,t.number,t.name,t.role)}}},[e._v("Update")]),a("v-btn",{staticClass:"ml-4 mr-4 white--text",attrs:{color:"red"},on:{click:function(a){return e.deleteUser(t.userUid,t.number)}}},[e._v("Delete "),a("v-icon",{attrs:{right:"",dark:""}},[e._v(" mdi-delete ")])],1),a("br"),a("br")],1)],1),a("br")],1)})),e.showAdd?a("v-row",{attrs:{justify:"center"}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{color:"primary",dark:""}},"v-btn",n,!1),o),[e._v(" + Add User")])]}}],null,!1,2487010233),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",[e._v("User Details")])]),a("v-card-text",[a("v-text-field",{attrs:{type:"text",label:"Name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("v-text-field",{attrs:{type:"text",rules:e.numberRules,label:"Phone Number"},model:{value:e.phno,callback:function(t){e.phno=t},expression:"phno"}}),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-select",{attrs:{items:["ADMIN","AGENT"],label:"Role",required:""},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}})],1)],1)],1),a("v-card-actions",[a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Cancel ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(t){return e.addUser()}}},[e._v(" save ")])],1)],1)],1)],1):e._e()],2)],1),a("br"),a("br")],1)],1)],1)],1)],1)])},n=[],r=a("53ca"),l=(a("159b"),a("b0c0"),a("d3b7"),a("252b")),s=a("56d7"),d={created:function(){var e=this;l["a"].auth().onAuthStateChanged((function(t){t&&(console.log("logged user details",t),e.uid=t.uid,console.log("page Managers il user id",e.uid),s["db"].collection("users").where("uid","==",e.uid).get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data());var a=t.data();if(e.ownerid=a.OwnerUid,e.uid=a.uid,e.max_user=a.PlanNumberOfUsers,console.log(a.role),"ADMIN"==a.role){e.ownerid=a.OwnerUid,console.log("admins owner",e.ownerid);var o=0;s["db"].collection("users").where("OwnerUid","==",e.ownerid).get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data());var a=t.data();e.Udata=a,e.Udata.UserStatus&&(o++,o==e.max_user?(console.log(o),e.showAdd=!1):e.showAdd=!0,e.detail=Object.assign({},e.detail,{name:e.Udata.Name,number:e.Udata.PhoneNumber,role:e.Udata.role,userUid:e.Udata.uid}),e.realdata.push(e.detail),e.userUid=e.Udata.uid,console.log(Object(r["a"])(e.detail)),console.log(e.realdata))}))})).catch((function(e){console.log("Error getting documents: ",e)}))}else"OWNER"==a.role&&(e.ownerid=a.uid,o=0,console.log("owner annu",e.ownerid),s["db"].collection("users").where("OwnerUid","==",e.ownerid).get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data());var a=t.data();e.Udata=a,e.Udata.UserStatus&&(o++,o==e.max_user?(console.log(o),e.showAdd=!1):e.showAdd=!0,e.detail=Object.assign({},e.detail,{name:e.Udata.Name,number:e.Udata.PhoneNumber,role:e.Udata.role,userUid:e.Udata.uid}),e.realdata.push(e.detail),e.userUid=e.Udata.uid,console.log(Object(r["a"])(e.detail)),console.log(e.realdata))}))})).catch((function(e){console.log("Error getting documents: ",e)})))}))})).catch((function(e){console.log("Error getting documents: ",e)})))}))},data:function(){return{uid:"",phno:"",name:"",role:"",detail:{},Udata:[],realdata:[],userUid:"",dialog:!1,showAdd:!0,isReadOnly:1,editing:!0,ownerid:"",max_user:"",numberRules:[function(e){return/^[0-9]*$/.test(e)||"No characters Allowed"}]}},methods:{editData:function(){this.isReadOnly=0,this.editing=!1},addUser:function(){var e=this;if(10!=this.phno.length)alert("Invalid Phone Number Format !");else if(""==this.name)alert("name required!!");else if(""==this.role)alert("Role required");else{var t=localStorage.getItem("token");console.log(t);var a={url:"https://asia-south1-tringpartner-v2.cloudfunctions.net/tpv2/addon/user",method:"POST",headers:{token:t},data:{user_name:this.name,user_number:this.phno,role:this.role,created_by:this.uid,owner_uid:this.ownerid}};console.log(a),this.$axios(a).then((function(e){console.log(e)})).catch((function(e){console.error(e)})).finally((function(){e.dialog=!1,alert("User added successfully");var t=0;e.realdata=[],s["db"].collection("users").where("OwnerUid","==",e.ownerid).get().then((function(a){a.forEach((function(a){console.log(a.id," => ",a.data());var o=a.data();e.Udata=o,e.Udata.UserStatus&&(t++,t==e.max_user?(console.log("add",t),e.showAdd=!1):e.showAdd=!0,e.detail=Object.assign({},e.detail,{name:e.Udata.Name,number:e.Udata.PhoneNumber,role:e.Udata.role,userUid:e.Udata.uid}),e.realdata.push(e.detail),e.userUid=e.Udata.uid,e.name="",e.phno="",e.role="",console.log(Object(r["a"])(e.detail)),console.log(e.realdata))}))})).catch((function(e){console.log("Error getting documents: ",e)}))}))}},updateUser:function(e,t,o,n){var l=this,d=localStorage.getItem("token");console.log(d);var i=a("bc3a"),c=JSON.stringify({user_name:o,user_number:t,role:n,user_uid:e,updated_by:this.uid}),u={method:"PUT",url:"https://asia-south1-tringpartner-v2.cloudfunctions.net/tpv2/addon/user",headers:{token:d,"Content-Type":"application/json"},data:c};console.log(u),i(u).then((function(e){console.log(JSON.stringify(e.data))})).catch((function(e){console.log(e)})).finally((function(){alert("successfully updated"),l.isReadOnly=1,l.editing=!0;var e=0;l.realdata=[],s["db"].collection("users").where("OwnerUid","==",l.ownerid).get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data());var a=t.data();l.Udata=a,l.Udata.UserStatus&&(e++,e==l.max_user?(console.log("delete",e),l.showAdd=!1):l.showAdd=!0,l.detail=Object.assign({},l.detail,{name:l.Udata.Name,number:l.Udata.PhoneNumber,role:l.Udata.role,userUid:l.Udata.uid}),l.realdata.push(l.detail),l.userUid=l.Udata.uid,console.log(Object(r["a"])(l.detail)),console.log(l.realdata))}))})).catch((function(e){console.log("Error getting documents: ",e)}))}))},deleteUser:function(e,t){var a=this;if(confirm("This user will be deleted permanently.Press Ok to confirm")){var o=localStorage.getItem("token");console.log(o);var n={url:"https://asia-south1-tringpartner-v2.cloudfunctions.net/tpv2/addon/user",method:"DELETE",headers:{token:o},data:{user_uid:e,user_number:t,updated_by:this.uid}};console.log(n),this.$axios(n).then((function(e){console.log(e),e.data.status?alert("successfully Deleted"):alert(e.data.message)})).catch((function(e){console.error(e)})).finally((function(){var e=0;a.realdata=[],s["db"].collection("users").where("OwnerUid","==",a.ownerid).get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data());var o=t.data();a.Udata=o,a.Udata.UserStatus&&(e++,e==a.max_user?(console.log("delete",e),a.showAdd=!1):a.showAdd=!0,a.detail=Object.assign({},a.detail,{name:a.Udata.Name,number:a.Udata.PhoneNumber,role:a.Udata.role,userUid:a.Udata.uid}),a.realdata.push(a.detail),a.userUid=a.Udata.uid,console.log(Object(r["a"])(a.detail)),console.log(a.realdata))}))})).catch((function(e){console.log("Error getting documents: ",e)}))}))}}}},i=d,c=a("2877"),u=a("6544"),m=a.n(u),h=a("7496"),g=a("8336"),f=a("b0af"),b=a("99d9"),v=a("62ad"),U=a("a523"),p=a("169a"),w=a("0e8f"),x=a("4bd4"),y=a("132d"),_=a("a722"),O=a("0fd9"),k=a("b974"),N=a("8654"),A=Object(c["a"])(i,o,n,!1,null,null,null);t["default"]=A.exports;m()(A,{VApp:h["a"],VBtn:g["a"],VCard:f["a"],VCardActions:b["a"],VCardText:b["b"],VCardTitle:b["c"],VCol:v["a"],VContainer:U["a"],VDialog:p["a"],VFlex:w["a"],VForm:x["a"],VIcon:y["a"],VLayout:_["a"],VRow:O["a"],VSelect:k["a"],VTextField:N["a"]})}}]);
//# sourceMappingURL=manage_users.d4173dde.js.map