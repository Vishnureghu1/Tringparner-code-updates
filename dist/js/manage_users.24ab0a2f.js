(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["manage_users"],{"169a":function(t,e,a){"use strict";a("368e");var n=a("480e"),i=a("4ad4"),o=a("b848"),s=a("75eb"),r=a("e707"),l=a("e4d3"),d=a("21be"),c=a("f2e7"),u=a("a293"),h=a("58df"),m=a("d9bd"),v=a("80d2");const g=Object(h["a"])(i["a"],o["a"],s["a"],r["a"],l["a"],d["a"],c["a"]);e["a"]=g.extend({name:"v-dialog",directives:{ClickOutside:u["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:{type:[String,Number],default:"none"},noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:{type:[String,Number],default:"auto"}},data(){return{activatedBy:null,animate:!1,animateTimeout:-1,isActive:!!this.value,stackMinZIndex:200,previousActiveElement:null}},computed:{classes(){return{[("v-dialog "+this.contentClass).trim()]:!0,"v-dialog--active":this.isActive,"v-dialog--persistent":this.persistent,"v-dialog--fullscreen":this.fullscreen,"v-dialog--scrollable":this.scrollable,"v-dialog--animated":this.animate}},contentClasses(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive(t){var e;t?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null==(e=this.previousActiveElement)||e.focus())},fullscreen(t){this.isActive&&(t?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created(){this.$attrs.hasOwnProperty("full-width")&&Object(m["e"])("full-width",this)},beforeMount(){this.$nextTick(()=>{this.isBooted=this.isActive,this.isActive&&this.show()})},beforeDestroy(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick(){this.animate=!1,this.$nextTick(()=>{this.animate=!0,window.clearTimeout(this.animateTimeout),this.animateTimeout=window.setTimeout(()=>this.animate=!1,150)})},closeConditional(t){const e=t.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(e)||this.overlay&&e&&!this.overlay.$el.contains(e))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):r["a"].options.methods.hideScroll.call(this)},show(){!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick(()=>{this.$nextTick(()=>{this.previousActiveElement=document.activeElement,this.$refs.content.focus(),this.bind()})})},bind(){window.addEventListener("focusin",this.onFocusin)},unbind(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside(t){this.$emit("click:outside",t),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown(t){if(t.keyCode===v["x"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;const t=this.getActivator();this.$nextTick(()=>t&&t.focus())}this.$emit("keydown",t)},onFocusin(t){if(!t||!this.retainFocus)return;const e=t.target;if(e&&![document,this.$refs.content].includes(e)&&!this.$refs.content.contains(e)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some(t=>t.contains(e))){const t=this.$refs.content.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),e=[...t].find(t=>!t.hasAttribute("disabled"));e&&e.focus()}},genContent(){return this.showLazyContent(()=>[this.$createElement(n["a"],{props:{root:!0,light:this.light,dark:this.dark}},[this.$createElement("div",{class:this.contentClasses,attrs:{role:"document",tabindex:this.isActive?0:void 0,...this.getScopeIdAttrs()},on:{keydown:this.onKeydown},style:{zIndex:this.activeZIndex},ref:"content"},[this.genTransition()])])])},genTransition(){const t=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[t]):t},genInnerContent(){const t={class:this.classes,ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(t.style={...t.style,maxWidth:"none"===this.maxWidth?void 0:Object(v["g"])(this.maxWidth),width:"auto"===this.width?void 0:Object(v["g"])(this.width)}),this.$createElement("div",t,this.getContentSlot())}},render(t){return t("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach},attrs:{role:"dialog"}},[this.genActivator(),this.genContent()])}})},"368e":function(t,e,a){},"99d9":function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return l}));var n=a("b0af"),i=a("80d2");const o=Object(i["h"])("v-card__actions"),s=Object(i["h"])("v-card__subtitle"),r=Object(i["h"])("v-card__text"),l=Object(i["h"])("v-card__title");n["a"]},a210:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md10:""}},[a("v-card",{staticClass:"mx-auto"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[a("div"),a("div",[a("div",{staticClass:"ml-4 mr-4"},[a("h3",{staticClass:"mt-6 ml-5 mb-5 text-center"},[t._v("Managers users")])])]),t._l(t.realdata,(function(e){return a("v-form",{key:e.text,staticClass:"ml-4 mr-4",on:{submit:function(t){t.preventDefault()}}},[a("v-text-field",{attrs:{type:"text",label:"Name",readonly:1==t.isReadOnly},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"details.name"}}),a("v-text-field",{attrs:{type:"text",label:"Number",readonly:1==t.isReadOnly},model:{value:e.number,callback:function(a){t.$set(e,"number",a)},expression:"details.number"}}),a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"6"}},[a("v-select",{attrs:{items:["ADMIN","AGENT"],readonly:1==t.isReadOnly,label:"Role",dense:"",outlined:""},model:{value:e.role,callback:function(a){t.$set(e,"role",a)},expression:"details.role"}})],1),a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"3"}},[t.editing?a("v-btn",{staticClass:"ml-4 mr-4",attrs:{type:"submit",color:"primary"},on:{click:function(e){return e.preventDefault(),t.editData()}}},[t._v("Edit User")]):a("v-btn",{staticClass:"ml-4 mr-4",attrs:{type:"submit",color:"green"},on:{click:function(a){return a.preventDefault(),t.updateUser(e.userUid,e.number,e.name,e.role)}}},[t._v("Update")]),a("v-btn",{staticClass:"ml-4 mr-4 white--text",attrs:{color:"red"},on:{click:function(a){return t.deleteUser(e.userUid,e.number)}}},[t._v("Delete "),a("v-icon",{attrs:{right:"",dark:""}},[t._v(" mdi-delete ")])],1),a("br"),a("br")],1)],1),a("br")],1)})),t.showAdd?a("v-row",{attrs:{justify:"center"}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{color:"primary",dark:""}},"v-btn",i,!1),n),[t._v(" + Add User")])]}}],null,!1,2487010233),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",[t._v("User Details")])]),a("v-card-text",[a("v-text-field",{attrs:{type:"text",label:"Name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),a("v-text-field",{attrs:{type:"text",rules:t.numberRules,label:"Phone Number"},model:{value:t.phno,callback:function(e){t.phno=e},expression:"phno"}}),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-select",{attrs:{items:["ADMIN","AGENT"],label:"Role",required:""},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}})],1)],1)],1),a("v-card-actions",[a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.dialog=!1}}},[t._v(" Cancel ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){return t.addUser()}}},[t._v(" save ")])],1)],1)],1)],1):t._e()],2)],1),a("br"),a("br")],1)],1)],1)],1)],1)])},i=[],o=a("53ca"),s=(a("159b"),a("b0c0"),a("d3b7"),a("2591")),r=a("56d7"),l={created:function(){var t=this;s["a"].auth().onAuthStateChanged((function(e){e&&(console.log("logged user details",e),t.uid=e.uid,console.log("page Managers il user id",t.uid),r["db"].collection("users").where("uid","==",t.uid).get().then((function(e){e.forEach((function(e){console.log(e.id," => ",e.data());var a=e.data();if(t.ownerid=a.OwnerUid,t.uid=a.uid,t.max_user=a.PlanNumberOfUsers,console.log(a.role),"ADMIN"==a.role){t.ownerid=a.OwnerUid,console.log("admins owner",t.ownerid);var n=0;r["db"].collection("users").where("OwnerUid","==",t.ownerid).get().then((function(e){e.forEach((function(e){console.log(e.id," => ",e.data());var a=e.data();t.Udata=a,t.Udata.UserStatus&&(n++,n==t.max_user?(console.log(n),t.showAdd=!1):t.showAdd=!0,t.detail=Object.assign({},t.detail,{name:t.Udata.Name,number:t.Udata.PhoneNumber,role:t.Udata.role,userUid:t.Udata.uid}),t.realdata.push(t.detail),t.userUid=t.Udata.uid,console.log(Object(o["a"])(t.detail)),console.log(t.realdata))}))})).catch((function(t){console.log("Error getting documents: ",t)}))}else"OWNER"==a.role&&(t.ownerid=a.uid,n=0,console.log("owner annu",t.ownerid),r["db"].collection("users").where("OwnerUid","==",t.ownerid).get().then((function(e){e.forEach((function(e){console.log(e.id," => ",e.data());var a=e.data();t.Udata=a,t.Udata.UserStatus&&(n++,n==t.max_user?(console.log(n),t.showAdd=!1):t.showAdd=!0,t.detail=Object.assign({},t.detail,{name:t.Udata.Name,number:t.Udata.PhoneNumber,role:t.Udata.role,userUid:t.Udata.uid}),t.realdata.push(t.detail),t.userUid=t.Udata.uid,console.log(Object(o["a"])(t.detail)),console.log(t.realdata))}))})).catch((function(t){console.log("Error getting documents: ",t)})))}))})).catch((function(t){console.log("Error getting documents: ",t)})))}))},data:function(){return{uid:"",phno:"",name:"",role:"",detail:{},Udata:[],realdata:[],userUid:"",dialog:!1,showAdd:!0,isReadOnly:1,editing:!0,ownerid:"",max_user:"",numberRules:[function(t){return/^[0-9]*$/.test(t)||"No characters Allowed"}]}},methods:{editData:function(){this.isReadOnly=0,this.editing=!1},addUser:function(){var t=this;if(10!=this.phno.length)alert("Invalid Phone Number Format !");else if(""==this.name)alert("name required!!");else if(""==this.role)alert("Role required");else{var e=localStorage.getItem("token");console.log(e);var a={url:"https://asia-south1-tringpartner-v2.cloudfunctions.net/tpv2/addon/user",method:"POST",headers:{token:e},data:{user_name:this.name,user_number:this.phno,role:this.role,created_by:this.uid,owner_uid:this.ownerid}};console.log(a),this.$axios(a).then((function(t){console.log(t)})).catch((function(t){console.error(t)})).finally((function(){t.dialog=!1,alert("User added successfully");var e=0;t.realdata=[],r["db"].collection("users").where("OwnerUid","==",t.ownerid).get().then((function(a){a.forEach((function(a){console.log(a.id," => ",a.data());var n=a.data();t.Udata=n,t.Udata.UserStatus&&(e++,e==t.max_user?(console.log("add",e),t.showAdd=!1):t.showAdd=!0,t.detail=Object.assign({},t.detail,{name:t.Udata.Name,number:t.Udata.PhoneNumber,role:t.Udata.role,userUid:t.Udata.uid}),t.realdata.push(t.detail),t.userUid=t.Udata.uid,t.name="",t.phno="",t.role="",console.log(Object(o["a"])(t.detail)),console.log(t.realdata))}))})).catch((function(t){console.log("Error getting documents: ",t)}))}))}},updateUser:function(t,e,n,i){var s=this,l=localStorage.getItem("token");console.log(l);var d=a("bc3a"),c=JSON.stringify({user_name:n,user_number:e,role:i,user_uid:t,updated_by:this.uid}),u={method:"PUT",url:"https://asia-south1-tringpartner-v2.cloudfunctions.net/tpv2/addon/user",headers:{token:l,"Content-Type":"application/json"},data:c};console.log(u),d(u).then((function(t){console.log(JSON.stringify(t.data))})).catch((function(t){console.log(t)})).finally((function(){alert("successfully updated"),s.isReadOnly=1,s.editing=!0;var t=0;s.realdata=[],r["db"].collection("users").where("OwnerUid","==",s.ownerid).get().then((function(e){e.forEach((function(e){console.log(e.id," => ",e.data());var a=e.data();s.Udata=a,s.Udata.UserStatus&&(t++,t==s.max_user?(console.log("delete",t),s.showAdd=!1):s.showAdd=!0,s.detail=Object.assign({},s.detail,{name:s.Udata.Name,number:s.Udata.PhoneNumber,role:s.Udata.role,userUid:s.Udata.uid}),s.realdata.push(s.detail),s.userUid=s.Udata.uid,console.log(Object(o["a"])(s.detail)),console.log(s.realdata))}))})).catch((function(t){console.log("Error getting documents: ",t)}))}))},deleteUser:function(t,e){var a=this;if(confirm("This user will be deleted permanently.Press Ok to confirm")){var n=localStorage.getItem("token");console.log(n);var i={url:"https://asia-south1-tringpartner-v2.cloudfunctions.net/tpv2/addon/user",method:"DELETE",headers:{token:n},data:{user_uid:t,user_number:e,updated_by:this.uid}};console.log(i),this.$axios(i).then((function(t){console.log(t),t.data.status?alert("successfully Deleted"):alert(t.data.message)})).catch((function(t){console.error(t)})).finally((function(){var t=0;a.realdata=[],r["db"].collection("users").where("OwnerUid","==",a.ownerid).get().then((function(e){e.forEach((function(e){console.log(e.id," => ",e.data());var n=e.data();a.Udata=n,a.Udata.UserStatus&&(t++,t==a.max_user?(console.log("delete",t),a.showAdd=!1):a.showAdd=!0,a.detail=Object.assign({},a.detail,{name:a.Udata.Name,number:a.Udata.PhoneNumber,role:a.Udata.role,userUid:a.Udata.uid}),a.realdata.push(a.detail),a.userUid=a.Udata.uid,console.log(Object(o["a"])(a.detail)),console.log(a.realdata))}))})).catch((function(t){console.log("Error getting documents: ",t)}))}))}}}},d=l,c=a("2877"),u=a("6544"),h=a.n(u),m=a("7496"),v=a("8336"),g=a("b0af"),f=a("99d9"),b=a("62ad"),p=a("a523"),w=a("169a"),U=a("0e8f"),y=a("4bd4"),x=a("132d"),_=a("a722"),O=a("0fd9"),k=a("b974"),A=a("8654"),C=Object(c["a"])(d,n,i,!1,null,null,null);e["default"]=C.exports;h()(C,{VApp:m["a"],VBtn:v["a"],VCard:g["a"],VCardActions:f["a"],VCardText:f["b"],VCardTitle:f["c"],VCol:b["a"],VContainer:p["a"],VDialog:w["a"],VFlex:U["a"],VForm:y["a"],VIcon:x["a"],VLayout:_["a"],VRow:O["a"],VSelect:k["a"],VTextField:A["a"]})},b0c0:function(t,e,a){var n=a("83ab"),i=a("9bf2").f,o=Function.prototype,s=o.toString,r=/^\s*function ([^ (]*)/,l="name";n&&!(l in o)&&i(o,l,{configurable:!0,get:function(){try{return s.call(this).match(r)[1]}catch(t){return""}}})}}]);
//# sourceMappingURL=manage_users.24ab0a2f.js.map